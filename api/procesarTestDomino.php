<?php
$paginaError = 
"
<!DOCTYPE html>
<html lang='es'>
<head>
    <!--Import Google Icon Font-->
    <link href='https://fonts.googleapis.com/icon?family=Material+Icons' rel='stylesheet'>
    <!-- Compiled and minified CSS -->
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css'>
    <!-- Hoja de estilos propia -->
    <link rel='stylesheet' href='../css/main.css'>
    <!-- Hoja de estilos de fontello -->
    <link rel='stylesheet' href='../css/fontello.css'>
    <!-- Favicon -->
    <link rel='shortcut icon' href='../img/favicon.png' type='image/png'>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <meta http-equiv='X-UA-Compatible' content='ie=edge'>
    <title>TÉCNICAS E INSTRUMENTOS DE EVALUACIÓN</title>
</head>

<body style='background-color: #f7f7f7'>


<div class='fixed-action-btn'>
        <a href='#!' style='background: #003a5c' data-target='mobile-demo'
            class='btn-floating btn-large sidenav-trigger'>
            <i class='large material-icons'>menu</i>
        </a>
</div>

<ul class='sidenav' id='mobile-demo' style='background: #003a5c'>
        <li><a href='../index.php' class='white-text'>Inicio</a></li>
        <li><a href='../perfil-descriptivo.php' class='white-text'>Perfil descriptivo</a></li>
        <li><a href='../tecnicas-e-instrumentos-de-evaluacion.php' class='white-text'>Técnicas e instrumentos de evaluación</a></li>
        <li><a href='../tests.php' class='white-text'>Test's</a></li>
</ul>
<nav class='nav-extended'>
    <div class='nav-wrapper'>
        <div class='row' style='background: #FFAD40; margin:0'>
            <div class='center'>
                <div class='col s3'>
                    <img src='../img/logo-unidep.png' alt='logo unidep' style='max-height: 50px; margin-top:28px'>
                </div>
                <div class='col s6 '>
                    <p class='center' style='font-size: 30px; margin-top:20px; margin-bottom: 0'>
                        <h1 style='font-size: 30px; margin-top:40px; margin-bottom: 0'>TÉCNICAS E
                            INSTRUMENTOS DE EVALUACIÓN</h1>
                    </p>
                </div>
                <div class='col s3' style='padding: 0'>
                    <img src='../img/logo-psicologia.png' alt='logo unidep' style='max-height:50px; margin-top:28px'>
                </div>
            </div>
        </div>
    </div>
</nav>

<!-- Banner con efecto parallax -->
<div class='parallax-container'>
        <div class='parallax'><img style='max-width: 90%' src='../img/banner-resultado.jpg'></div>
</div>

    <div class='row'>

        <!-- Menú expandible izquierdo -->
        <div class='col s3'>
            <div style='margin-top:30px'>
    <ul class='collapsible'>
        <li>
            <div class='collapsible-header light-blue-text text-darken-4'>
                <i class='material-icons'>account_box
                </i>
                Perfil descriptivo
                <span class='new badge light-blue darken-4' data-badge-caption='6'></span></div>
            <div class='collapsible-body'>
                <p><a href='../perfil-descriptivo/tema-1.php' class='light-blue-text text-darken-4'>Tema 1: Evaluación de competencia
                        laboral.</a></p>
            </div>
            <div class='collapsible-body'>
                <p> <a href='../perfil-descriptivo/tema-2.php' class='light-blue-text text-darken-4'>Tema 2: Selección de las técnicas e
                        instrumentos de evaluación.</a></p>
            </div>
            <div class='collapsible-body'>
                <p><a href='../perfil-descriptivo/tema-3.php' class='light-blue-text text-darken-4'>Tema 3: Identificación de los contenidos
                        de evaluación.</a></p>
            </div>
            <div class='collapsible-body'>
                <p><a href='../perfil-descriptivo/tema-4.php' class='light-blue-text text-darken-4'>Tema 4: Estructura de un plan de
                        evaluación.</a></p>
            </div>
            <div class='collapsible-body'>
                <p><a href='../perfil-descriptivo/tema-5.php' class='light-blue-text text-darken-4'>Tema 5: Comprobación de la autenticidad
                        de la evidencia histórica presentada
                        por el candidato.</a></p>
            </div>
            <div class='collapsible-body'>
                <p><a href='../perfil-descriptivo/tema-6.php' class='light-blue-text text-darken-4'>Tema 6: Como registrar la contrastación
                        de las evidencias recopiladas contra
                        UCL.</a></p>
            </div>
        </li>
        <li>
            <div class='collapsible-header  cyan-text text-darken-4'>
                <i class='material-icons'>insert_drive_file
                </i>
                Técnicas e instrumentos de evaluación
                <span class='new badge   cyan darken-4' data-badge-caption='4'></span></div>
            <div class='collapsible-body'>
                <p><a href='../tecnicas-e-instrumentos-de-evaluacion/observacion.php' class='cyan-text text-darken-4'>Observación</a></p>
            </div>
            <div class='collapsible-body'>
                <p><a href='../tecnicas-e-instrumentos-de-evaluacion/entrevista.php' class='cyan-text text-darken-4'>Entrevista</a></p>
            </div>
            <div class='collapsible-body'>
                <p><a href='../tecnicas-e-instrumentos-de-evaluacion/encuesta.php' class='cyan-text text-darken-4'>Encuesta</a></p>
            </div>
            <div class='collapsible-body'>
                <p><a href='../tecnicas-e-instrumentos-de-evaluacion/prueba.php' class='cyan-text text-darken-4'>Prueba</a></p>
            </div>
        </li>
        <li>
            <div class='collapsible-header teal-text text-darken-4'>
                <i class='material-icons'>recent_actors</i>
                Test's
                <span class='new badge teal darken-4' data-badge-caption='6'></span></div>
            <div class='collapsible-body'>
                <p><a href='test-domino.php' class='teal-text text-darken-4'>Test Domino</a></p>
            </div>
            <div class='collapsible-body'>
                <p><a href='test-de-raven.php' class='teal-text text-darken-4'>Test de Raven</a></p>
            </div>
            <div class='collapsible-body'>
                <p><a href='test-de-terman-mirrel.php' class='teal-text text-darken-4'>Test de Terman Mirrel</a></p>
            </div>
            <div class='collapsible-body'>
                <p><a href='test-de-colores.php' class='teal-text text-darken-4'>Test de Colores</a></p>
            </div>
            <div class='collapsible-body'>
                <p><a href='test-de-moss.php' class='teal-text text-darken-4'>Test de Moss</a></p>
            </div>
            <div class='collapsible-body'>
                <p><a href='test-de-cleaver.php' class='teal-text text-darken-4'>Test de Cleaver</a></p>
            </div>
        </li>
    </ul>
</div>        </div>

        <!-- Contenido de la página -->
        <div class='col s9'>
            <div class='container'>
                <h4 class='center'>Test Domino - Resultado</h4>

                <h3 class='center red-text'> No puede acceder al resultado sin realizar el test! </h3>
                
                

                <p class='right'>
                <a href='test-domino.php' class='waves-effect waves-light btn-small brown darken-3 pulse'><i class='material-icons right'>reply</i>REGRESAR</a>
                </p>
                   
            </div>

        </div>       
    </div>



    <!-- FOOTER -->
    <footer class='page-footer' style='padding: 0px; margin: 0px; background: #FFAD40'>
        <div class='footer-copyright'>
            <div class='row' style='margin-bottom:0; margin-top:0;'>
            <div class='container' style='margin-bottom:0'>
                <div class='col s6' style='padding: 0'>
                <p class='right white-text' style='margin-bottom: 0; padding: 0; margin-top: .3em'>Desarrollado por:</p>         
                </div>
                <div class='col s6'>
                <p class='left' style='margin: 0; padding: 0'>
                <a class='white-text text-lighten-3'
                href='http://www.beekha.com'>
                <img src='../img/beekha_logo_3.png'  style='max-width: 70%' alt='logo beekhá'>
                </a>
                </p>
                </div>
            </div>
            </div>
        </div>
    </footer>

    <!-- Compiled and minified JavaScript -->
    <script src='https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js'></script>

    <!-- Inicializar los JS del proyecto -->
    <script>

        M.AutoInit();

        document.addEventListener('DOMContentLoaded', function () {
            var elems = document.querySelectorAll('.sidenav');
            var instances = M.Sidenav.init(elems,
                {
                    edge: 'right',
                    outDuration: 1000,
                    inDuration: 1500,
                    draggable: false
                });
        });

        document.addEventListener('DOMContentLoaded', function () {
            var elems = document.querySelectorAll('.parallax');
            var instances = M.Parallax.init(elems);
        });


        document.addEventListener('DOMContentLoaded', function () {
            var elems = document.querySelectorAll('.fixed-action-btn');
            var instances = M.FloatingActionButton.init(elems,
                {
                    direction: 'left'
                });
        });


        
    </script>
</body>

</html>
";

$seguridad = true;

if($seguridad){
    if (!$_POST) {
        echo $paginaError;
        die();
    }
}



function obtenerPercentil($edad, $aciertos)
{
    $rangoEdadUno = [9, 14, 22, 27, 32, 35, 38];
    $rangoEdadDos = [11, 15, 23, 28, 33, 37, 39];
    $rangoEdadTres = [12, 16, 24, 29, 34, 39, 41];
    $rangoEdadCuatro = [16, 20, 25, 31, 36, 40, 41];
    $percentil = 0;

    if ($edad >= 12 && $edad <= 13) {
        if ($aciertos < $rangoEdadUno[0]) {
            $percentil = 0;
        }
        if ($aciertos >= $rangoEdadUno[0] && $aciertos < $rangoEdadUno[1]) {
            $percentil = 5;
        }
        if ($aciertos >= $rangoEdadUno[1] && $aciertos < $rangoEdadUno[2]) {
            $percentil = 10;
        }
        if ($aciertos >= $rangoEdadUno[2] && $aciertos < $rangoEdadUno[3]) {
            $percentil = 25;
        }
        if ($aciertos >= $rangoEdadUno[3] && $aciertos < $rangoEdadUno[4]) {
            $percentil = 50;
        }
        if ($aciertos >= $rangoEdadUno[4] && $aciertos < $rangoEdadUno[5]) {
            $percentil = 75;
        }
        if ($aciertos >= $rangoEdadUno[5] && $aciertos < $rangoEdadUno[6]) {
            $percentil = 90;
        }
        if ($aciertos >= $rangoEdadUno[6]) {
            $percentil = 95;
        }        
    }

    if ($edad >= 14 && $edad <= 15) {
        if ($aciertos < $rangoEdadDos[0]) {
            $percentil = 0;
        }
        if ($aciertos >= $rangoEdadDos[0] && $aciertos < $rangoEdadDos[1]) {
            $percentil = 5;
        }
        if ($aciertos >= $rangoEdadDos[1] && $aciertos < $rangoEdadDos[2]) {
            $percentil = 10;
        }
        if ($aciertos >= $rangoEdadDos[2] && $aciertos < $rangoEdadDos[3]) {
            $percentil = 25;
        }
        if ($aciertos >= $rangoEdadDos[3] && $aciertos < $rangoEdadDos[4]) {
            $percentil = 50;
        }
        if ($aciertos >= $rangoEdadDos[4] && $aciertos < $rangoEdadDos[5]) {
            $percentil = 75;
        }
        if ($aciertos >= $rangoEdadDos[5] && $aciertos < $rangoEdadDos[6]) {
            $percentil = 90;
        }
        if ($aciertos >= $rangoEdadDos[6]) {
            $percentil = 95;
        }
    }

    if ($edad >= 16 && $edad <= 17) {
        if ($aciertos < $rangoEdadTres[0]) {
            $percentil = 0;
        }
        if ($aciertos >= $rangoEdadTres[0] && $aciertos < $rangoEdadTres[1]) {
            $percentil = 5;
        }
        if ($aciertos >= $rangoEdadTres[1] && $aciertos < $rangoEdadTres[2]) {
            $percentil = 10;
        }
        if ($aciertos >= $rangoEdadTres[2] && $aciertos < $rangoEdadTres[3]) {
            $percentil = 25;
        }
        if ($aciertos >= $rangoEdadTres[3] && $aciertos < $rangoEdadTres[4]) {
            $percentil = 50;
        }
        if ($aciertos >= $rangoEdadTres[4] && $aciertos < $rangoEdadTres[5]) {
            $percentil = 75;
        }
        if ($aciertos >= $rangoEdadTres[5] && $aciertos < $rangoEdadTres[6]) {
            $percentil = 90;
        }
        if ($aciertos >= $rangoEdadTres[6]) {
            $percentil = 95;
        }
    }

    if ($edad >= 18 && $edad <= 65) {
        if ($aciertos < $rangoEdadTres[0]) {
            $percentil = 0;
        }
        if ($aciertos >= $rangoEdadCuatro[0] && $aciertos < $rangoEdadCuatro[1]) {
            $percentil = 5;
        }
        if ($aciertos >= $rangoEdadCuatro[1] && $aciertos < $rangoEdadCuatro[2]) {
            $percentil = 10;
        }
        if ($aciertos >= $rangoEdadCuatro[2] && $aciertos < $rangoEdadCuatro[3]) {
            $percentil = 25;
        }
        if ($aciertos >= $rangoEdadCuatro[3] && $aciertos < $rangoEdadCuatro[4]) {
            $percentil = 50;
        }
        if ($aciertos >= $rangoEdadCuatro[4] && $aciertos < $rangoEdadCuatro[5]) {
            $percentil = 75;
        }
        if ($aciertos >= $rangoEdadCuatro[5] && $aciertos < $rangoEdadCuatro[6]) {
            $percentil = 90;
        }
        if ($aciertos >= $rangoEdadCuatro[6]) {
            $percentil = 95;
        }
    }

    return $percentil;
}

function obtenerRango($percentil)
{
    $rango = '';

    if ($percentil == 0) {
        $rango = 'NO ES POSIBLE OBTENER UN RANGO';
    }
    if ($percentil == 5) {
        $rango = 'DEFICIENTE';
    }
    if ($percentil == 10 || $percentil == 25) {
        $rango = 'INFERIOR AL TÉRMINO MEDIO';
    }
    if ($percentil == 50) {
        $rango = 'TÉRMINO MEDIO';
    }
    if ($percentil == 75 || $percentil == 90) {
        $rango = 'SUPERIOR AL TÉRMINO MEDIO';
    }
    if ($percentil == 95) {
        $rango = 'SUPERIOR';
    }

    return $rango;
}

/*
if ($_POST) {
    foreach ($_POST as $clave => $valor) {
        echo "El valor de $clave es: $valor <br>";
    }
}
*/

$respuestas = $_POST;
$correctas = [0, 2, 4, 6, 1, 3, 5, 0, 2, 4, 1, 3, 6, 5, 2, 0, 4, 2, 6, 3, 3, 4, 0, 5, 1, 2, 3, 5, 6, 1, 4, 2, 5, 6, 0, 1, 4, 2, 2, 1, 5, 0, 4, 6, 3, 2, 1, 3, 5, 6, 4, 3, 0, 1, 5, 2, 4, 5, 5, 3, 6, 5, 6, 4, 0, 4, 4, 1, 0, 6, 2, 3, 5, 6, 0, 4, 6, 3, 5, 2, 1, 5, 1, 0, 6, 4, 6, 3, 0, 2, 5, 5, 6, 2, 2, 1, 3];
$aciertos = 0;
$edad = $respuestas[0];
$contador = 1;

while ($contador <= 96) {
    if (($respuestas[$contador] == $correctas[$contador]) && ($respuestas[$contador + 1] == $correctas[$contador + 1])) {
        ++$aciertos;
    }
    $contador = $contador + 2;
}

$percentil = obtenerPercentil($edad, $aciertos);
$rango = obtenerRango($percentil);

/*
echo 'Edad: '.$edad.'<br>';
echo 'Percentil: '.$percentil.'<br>';
echo 'Rango: '.$rango.'<br>';
echo 'Aciertos: '.$aciertos.'<br>';
*/
